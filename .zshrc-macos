echo "=== .zshrc-macos ==="

echo "Setting MacOS alias'..."
alias update="brew upgrade;set-last-update-time;cd ~/Applications;xattr -r -d com.apple.quarantine *;kitten notify 'Nya!' Updates complete ðŸ’ª"
alias venv="source ~/.venv/bin/activate"
alias copydir="pwd | sed 's:.*/::' | pbcopy"
alias copypwd="pwd | pbcopy"

echo "Exporting custom variables..."
export _JAVA_OPTIONS="-Xms256m -Xmx24g -XX:ReservedCodeCacheSize=256m -XX:MaxMetaspaceSize=1G -Dhttp.netty.maxHeaderSize=16384 -Xss256m -XX:+HeapDumpOnOutOfMemoryError -Dhudson.plugins.git.GitSCM.ALLOW_LOCAL_CHECKOUT=true"
export JAVA_TOOL_OPTIONS="-Djavax.net.ssl.trustStore=$JAVA_HOME/lib/security/cacerts"
export NODE_OPTIONS=--max-http-header-size=16385
export HOMEBREW_CASK_OPTS="--appdir=${HOME}/Applications"
export HOMEBREW_NO_ENV_HINTS="1"
export NVM_BIN="/usr/local/bin/node"
export NVM_DIR="$HOME/.nvm"

echo "Sourcing scripts..."
[ -s "/opt/homebrew/opt/nvm/nvm.sh" ] && \. "/opt/homebrew/opt/nvm/nvm.sh"  # This loads nvm
[ -s "/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm" ] && \. "/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm"  # This loads nvm bash_completion

echo "Checking if updates are needed..."
# these scripts should be in that sourced folder earlier
UPDATE_NEEDED=$(check-if-update-needed)
UPDATE_NEEDED=$((UPDATE_NEEDED))

if [[ UPDATE_NEEDED -eq 1 ]]
then
    clear
    echo "Brew hasn't been updated in over 30 days - update is needed."
    if read -q "choice?Press Y to continue, or anything else to dismiss... "
    then
        clear
        update
        echo "Up to date"
    fi
fi

clear
fastfetch